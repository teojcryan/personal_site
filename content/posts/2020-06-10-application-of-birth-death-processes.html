---
title: COVID-19 as a Birth-Death Process
author: ~
date: '2020-04-25'
slug: application-of-birth-death-processes
categories: ["stochastic-modelling", "epidemiology"]
tags: ["covid-19", "birth-death-processes"]
bibliography: [2020-06-10-application-of-birth-death-processes.bib]
link-citations: true
math: true
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="summary" class="section level1">
<h1>Summary</h1>
<p>This report was produced for a course in stochastic processes. I explored how birth-death processes, a type of continuous time Markov chain, could be applied to epidemic modelling. I found that framing epidemic outbreaks as birth-death processes allows one to estimate the probability of a major epidemic occurring, and the subsequent duration and final sizes. The projections in the report are not meant to be accurate as the models made numerous unrealistic assumptions - this was just an academic exercise in modelling.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>COVID-19 has been declared a global pandemic by the WHO <span class="citation">(<a href="#ref-cucinotta_who_2020" role="doc-biblioref">Cucinotta and Vanelli 2020</a>)</span>, and a lot of attention has been focused on the
development of epidemiological models to understand its dynamics. The
Susceptible-Infectious-Removed (SIR) epidemic model is a well-known
model that captures the dynamics of an epidemic <span class="citation">(<a href="#ref-mckendrick_applications_1925" role="doc-biblioref">McKendrick 1925</a>)</span>. A SIR model comprises of three compartments, <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span>,
and <span class="math inline">\(R\)</span> that represent the number of people in a population who are
susceptible to, infected by and have recovered from a disease (and are
therefore immune). The transitions between the states are determined by
ordinary differential equations (ODEs) detailed in the equations below.</p>
<p><span class="math display">\[\frac{dS}{dt} = - \beta I\frac{S}{N}\]</span></p>
<p><span class="math display">\[\frac{dI}{dt} = \beta I\frac{S}{N} - \gamma I\]</span>
<span class="math display">\[\frac{dI}{dt} = \gamma I \]</span></p>
<p>where <span class="math inline">\(\beta,\ \gamma\)</span> represent the rate of transmission and rate of
recovery of the disease. The basic reproduction number
<span class="math inline">\(R_{0} = \beta\text{/}\gamma\)</span> refers to the expected number of secondary
cases directly generated by one case in a fully susceptible population,
in the absence of any intervention.</p>
<p>The model described above is deterministic and does not have any
inherent randomness. In other words, given certain parameters, the model
will only output one fixed trajectory of an epidemic. Deterministic
models are valid for sufficiently large populations, but are unable to
capture typically stochastic phenomena like extinction <span class="citation">(<a href="#ref-rock_dynamics_2014" role="doc-biblioref">Rock et al. 2014</a>)</span>. In situations where the number of infectious individuals is small
or when the variability in transmission and recovery impacts the
epidemic outcome, the randomness in stochastic models are more
appropriate <span class="citation">(<a href="#ref-allen_primer_2017" role="doc-biblioref">Allen 2017</a>)</span>.</p>
<p>The objective of this project is to explore the stochastic SIR epidemic
model in the framework of a continuous-time Markov chain – more
specifically, a birth-death process (BDP). This includes explaining the
theoretical formulation of an SIR BDP, before fitting it onto COVID-19
case data and conducting simulation-based inference from the models.</p>
</div>
<div id="methods" class="section level1">
<h1>2 Methods</h1>
<div id="sir-as-a-continuous-time-markov-chain-birth-death-process" class="section level2">
<h2>2.1 SIR as a Continuous-Time Markov Chain &amp; Birth-Death Process</h2>
<p>To formulate the SIR model as a continuous-time Markov chain (CTMC), two
discrete random variables <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> are defined to record the number
of susceptible and infectious individuals in a homogeneously mixed
closed population of size <span class="math inline">\(N\)</span>, such that:</p>
<center>
<span class="math inline">\(S\left( t \right),I\left( t \right) \in \text{\{}0,1,\ldots,N\text{\}}\)</span>
where <span class="math inline">\(t \in \left\lbrack 0,\infty \right)\)</span>
</center>
<p>For a small period of time <span class="math inline">\(\Delta t\)</span>, the transition probabilities for
the stochastic process are:</p>
<p><span class="math display">\[\begin{align*}
P_{\left( s,i \right),\left( s + k,i + j \right)}&amp;\left( \Delta t \right) =\\ &amp;P\lbrack(S(t + \Delta t),\ I(t + \Delta t) = (s + k,i + j)|(S(t),I(t) = (s,i)\rbrack
\end{align*}\]</span></p>
<p>The CTMC is a time-homogeneous process, in that the transition
probabilities do not depend on specific values of <span class="math inline">\(t\)</span> but only on the
time between events, <span class="math inline">\(\Delta t\)</span>. Furthermore, according to the Markov
property, the state of the process at time <span class="math inline">\(t + \Delta t\)</span> depends only
on the state at time <span class="math inline">\(t\)</span> and not any states prior to <span class="math inline">\(t\)</span>. A birth-death
process (BDP) is a special case of the CTMC where the state variable can
only increase or decrease by 1. Under the assumption of a closed
population, the rate of births, deaths and immigration in reality is
negligible and do not affect the epidemic dynamics. Mathematically, this
means that <span class="math inline">\(N - S\left( t \right) - I\left( t \right)\)</span> remains constant.
Thus, the only transition probabilities are related to infection and
recovery, as summarised below.</p>
<center>
<table>
<colgroup>
<col width="28%" />
<col width="35%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Event</th>
<th align="center">Change <span class="math inline">\(\left( \Delta S,\Delta I \right)\)</span></th>
<th align="center">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Infection</td>
<td align="center"><span class="math display">\[\left( - 1, + 1 \right)\]</span></td>
<td align="center"><span class="math display">\[\beta i\frac{s}{N}\Delta t + o\left( \Delta t \right)\]</span></td>
</tr>
<tr class="even">
<td align="left">Recovery</td>
<td align="center"><span class="math display">\[\left( 0, - 1 \right)\]</span></td>
<td align="center"><span class="math display">\[\text{γi}\Delta t + o\left( \Delta t \right)\]</span></td>
</tr>
</tbody>
</table>
</center>
<p>The model is initialised at time <span class="math inline">\(t = 0\)</span> for some infected individuals
<span class="math inline">\(I\left( 0 \right) = i &gt; 0\)</span> and <span class="math inline">\(S\left( 0 \right) = N - i\)</span> susceptible
individuals, and the epidemic ends when <span class="math inline">\(I\left( t \right) = 0\)</span>. In
other words, the states <span class="math inline">\(\left( s,0 \right)\)</span> for all possible <span class="math inline">\(s\)</span> are
absorbing states.</p>
</div>
<div id="parameter-estimation" class="section level2">
<h2>2.2 Parameter estimation</h2>
<div id="data" class="section level3">
<h3>2.2.1 Data</h3>
<p>The dataset used in this paper was sourced from the Johns Hopkins
University COVID-19 repository <span class="citation">(<a href="#ref-jhu_csse_novel_2020" role="doc-biblioref">CSSE 2020</a>)</span>. The repository contains
data on the daily number of confirmed cases, deaths and recovered cases
for every country affected by the pandemic and is updated daily.</p>
</div>
<div id="maximum-likelihood-estimation" class="section level3">
<h3>2.2.2 Maximum Likelihood Estimation</h3>
<p>The likelihood for a continuously observed BDP is formulated as such:</p>
<p><span class="math display">\[L = \prod_{k = 0}^{\infty}{\lambda_{k}}^{U_{k}}{\mu_{k}}^{D_{k}}\exp\left\lbrack - \left( \lambda_{k} + \mu_{k} \right)T_{k} \right\rbrack\]</span></p>
<p>where <span class="math inline">\(U_{k},D_{k}\)</span> are the number of up (arrivals) and down (removals)
steps respectively, and <span class="math inline">\(T_{k}\)</span> is the total time spent in state <span class="math inline">\(k\)</span>
over all visits to <span class="math inline">\(k\)</span> <span class="citation">(<a href="#ref-crawford_birth-death_2014" role="doc-biblioref">Crawford and Suchard 2014</a>)</span>. <span class="math inline">\(\lambda_{k},\mu_{k}\)</span> represent
the instantaneous rate at which arrivals and removals occur. For
simplification, the arrival and removal rates are assumed to be linear
<span class="math inline">\(\lambda_{k} = k\lambda,\mu_{k} = k\mu\)</span>, and this process is also known
as the Kendall process. In the context of an epidemic, an arrival refers
to an infection while a removal could refer to either a recovery or
death.</p>
<p>However, this likelihood is difficult to evaluate analytically because
the number of COVID-19 cases is only reported at discrete time points
(daily) rather than over a continuous time. When a BDP is sampled
discretely such that only <span class="math inline">\(X\left( 0 \right) = a\)</span> and
<span class="math inline">\(X\left( t \right) = b\)</span> are observed, the quantities <span class="math inline">\(U_{k}\)</span>, <span class="math inline">\(D_{k}\)</span>,
and <span class="math inline">\(T_{k}\)</span> are unknown for every state <span class="math inline">\(k\)</span>, and the log-likelihood
cannot be maximised without them <span class="citation">(<a href="#ref-crawford_estimation_2014" role="doc-biblioref">Crawford, Minin, and Suchard 2014</a>)</span>. Previous
studies have shown that a continuous-time BDP process observed at
equidistant points form a Galton-Watson process but the transition
probabilities are complex and direct maximum likelihood estimation did
not seem feasible <span class="citation">(<a href="#ref-keiding_maximum_1975" role="doc-biblioref">Keiding 1975</a>)</span>.</p>
<p>Therefore, a data augmentation technique was applied to approximate a
continuously observed BDP. This involved splitting the daily reported
case number into individual jumps of <span class="math inline">\(+ 1\)</span> or <span class="math inline">\(- 1\)</span> distributed by a
uniform distribution with a width equal to <span class="math inline">\(1\text{/}n\)</span>, where <span class="math inline">\(n\)</span>
refers to the number of cases that occurred on that day.</p>
<center>
<img src="/posts/2020-06-10-application-of-birth-death-processes_files/singapore%20cases.png" />
</center>
<p>An example of the result is illustrated above. On the 73<sup>rd</sup> day
since the first case in Singapore, there were 75 new cases and 16
recoveries reported. The data augmentation process split the time
interval (72,73) into 91 bins and computed 75 up steps
and 16 down steps at random. Conducting this data augmentation technique
on the daily case data enabled the maximisation of the likelihood
function to estimate the transition rates <span class="math inline">\(\lambda,\mu\)</span>.
These parameters can be thought of as the transmission and recovery rate
<span class="math inline">\(\beta,\gamma\)</span> in the SIR model although they are not completely the
same since <span class="math inline">\(\mu\)</span> includes both deaths and recoveries. Analogously,
<span class="math inline">\(\lambda\text{/}\mu\)</span> is a crude estimate of
<span class="math inline">\(R_{0} = \beta\text{/}\gamma\)</span>. The maximum likelihood (ML) estimates for
<span class="math inline">\(\lambda,\ \mu\)</span> and their respective standard errors are summarised below.</p>
<center>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="center"><span class="math inline">\(\lambda_{MLE}\)</span></th>
<th></th>
<th align="center">SE</th>
<th></th>
<th align="center"><span class="math inline">\(\mu_{MLE}\)</span></th>
<th></th>
<th align="center">SE</th>
<th align="center"><span class="math inline">\(\lambda/\mu\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="center">0.100</td>
<td></td>
<td align="center">2.06 <span class="math inline">\(\times\)</span> 10<sup>-7</sup></td>
<td></td>
<td align="center">0.0371</td>
<td></td>
<td align="center">1.25 <span class="math inline">\(\times\)</span> 10<sup>-7</sup></td>
<td align="center">2.71</td>
</tr>
<tr class="even">
<td align="left">Singapore</td>
<td align="center">0.138</td>
<td></td>
<td align="center">7.78 <span class="math inline">\(\times\)</span> 10<sup>-6</sup></td>
<td></td>
<td align="center">0.0163</td>
<td></td>
<td align="center">2.67 <span class="math inline">\(\times\)</span> 10<sup>-6</sup></td>
<td align="center">8.46</td>
</tr>
<tr class="odd">
<td align="left">South Korea</td>
<td align="center">0.0409</td>
<td></td>
<td align="center">7.77 <span class="math inline">\(\times\)</span> 10<sup>-7</sup></td>
<td></td>
<td align="center">0.0319</td>
<td></td>
<td align="center">6.86 <span class="math inline">\(\times\)</span> 10<sup>-7</sup></td>
<td align="center">1.28</td>
</tr>
<tr class="even">
<td align="left">Sweden</td>
<td align="center">0.0729</td>
<td></td>
<td align="center">1.37 <span class="math inline">\(\times\)</span> 10<sup>-6</sup></td>
<td></td>
<td align="center">0.0106</td>
<td></td>
<td align="center">5.21 <span class="math inline">\(\times\)</span> 10<sup>-7</sup></td>
<td align="center">6.88</td>
</tr>
<tr class="odd">
<td align="left">Thailand</td>
<td align="center">0.0766</td>
<td></td>
<td align="center">7.67 <span class="math inline">\(\times\)</span> 10<sup>-6</sup></td>
<td></td>
<td align="center">0.0547</td>
<td></td>
<td align="center">6.48 <span class="math inline">\(\times\)</span> 10<sup>-6</sup></td>
<td align="center">1.4</td>
</tr>
</tbody>
</table>
</center>
<p>A limitation of the linear BDP is that it assumed that rates
<span class="math inline">\(\lambda,\mu\)</span> are constant throughout the outbreak. This is not likely
to be true in reality as the rates are very sensitive to day-to-day
changes in the number of reported cases. For example, while Singapore
has been relatively successful in managing the epidemic initially, the
recent spike in cases reported in Singapore around 20<sup>th</sup> April
<span class="citation">(<a href="#ref-griffith_singapore_2020" role="doc-biblioref">Griffith 2020</a>)</span> have resulted in a sharp increase in <span class="math inline">\(\lambda\)</span>. Thus,
the estimates tend to vary greatly depending on the state of the
epidemic at the time.</p>
<p>As such, a more accurate interpretation of <span class="math inline">\(\lambda,\ \mu\)</span> is a
reflection how successful the countries have been in controlling the
epidemic. Low values of <span class="math inline">\(\lambda\)</span> indicate a success in reducing the
rate at which infections occur. The countries highlighted above were
selected to highlight a range of scenarios for different points of the
outbreak. South Korea has been shown to have largely controlled the
epidemic <span class="citation">(<a href="#ref-normile_coronavirus_2020" role="doc-biblioref">Normile 2020</a>)</span>, while the other countries are still dealing
with a large number of cases. The relative low rates of <span class="math inline">\(\lambda,\ \mu\)</span>
for South Korea support this statement. However, it should be noted that
the removal rate <span class="math inline">\(\mu\)</span> includes both recoveries and deaths, so while
Singapore and Sweden appear to have very high <span class="math inline">\(\lambda\text{/}\mu\)</span>
(which is analogous to <span class="math inline">\(R_{0}\)</span>), their situation may not be as bad as in
France, which has a relatively high <span class="math inline">\(\mu\)</span> that includes a large number
of deaths <span class="citation">(<a href="#ref-ward_why_2020" role="doc-biblioref">Ward 2020</a>)</span>.</p>
<p>Despite their simplification, the MLE estimates for <span class="math inline">\(\lambda,\mu\)</span> may
still serve to highlight how different epidemics are expected to
progress through simulation.</p>
</div>
</div>
</div>
<div id="simulation-based-results" class="section level1">
<h1>3 Simulation-based Results</h1>
<p>The estimated model parameters were used to simulate various
trajectories of the epidemic in the respective countries. The Gillespie
algorithm allows for the simulation of possible solutions of a
stochastic equation <span class="citation">(<a href="#ref-gillespie_exact_1977" role="doc-biblioref">Gillespie 1977</a>)</span> and can be applied in this
scenario. The pseudocode of the algorithm is provided below.</p>
<table style="width:99%;">
<colgroup>
<col width="98%" />
</colgroup>
<tbody>
<tr class="odd">
<td><ol style="list-style-type: lower-roman">
<li><p>Generate <span class="math inline">\(U_{1} \sim \text{Unif}\left\lbrack 0,1 \right\rbrack\)</span>
and <span class="math inline">\(U_{2} \sim \text{Unif}\left\lbrack 0,1 \right\rbrack\)</span></p></li>
<li><p>Calculate rate, <span class="math inline">\(\lambda = \beta*S*I\text{/}N + \gamma*I\)</span></p></li>
<li><p>Compute time to next event,
<span class="math inline">\(\tau = - \ln\left( U_{1} \right)\text{/}\lambda\)</span></p></li>
<li><p>Compute probability of up step,
<span class="math inline">\(p = \left( \beta*s*i\text{/}N \right)\text{/}\lambda\)</span></p></li>
<li><p>Compute direction of next event,
<span class="math inline">\(I_{\text{new}} = \text{binomial}\left( 1,p \right)*2 - 1\)</span></p></li>
<li><p>Update time <span class="math inline">\(t = t + \tau\)</span> and state <span class="math inline">\(I = I + I_{\text{new}}\)</span></p></li>
<li><p>If process is extinct, i.e. <span class="math inline">\(x = 0\)</span>, the simulation ends. Else,
return to step i.</p></li>
</ol></td>
</tr>
</tbody>
</table>
<p>The stochastic nature of each epidemic allows some inference to be made
about the paths of the epidemic. These include the i. probability of a
major outbreak, ii. the final size and iii. duration of the epidemic.
For each country, a total of 100 simulations were run until
<span class="math inline">\(I\left( t \right) = 0\)</span> and the extinction times
<span class="math inline">\(inf\text{\{}t &gt; 0|I(t) = 0\text{\}}\)</span> and final sizes of the epidemic
were recorded. The simulated results were then compared with their
deterministic ODE counterparts.</p>
<div id="probability-of-major-outbreak" class="section level2">
<h2>3.1 Probability of Major Outbreak</h2>
<p>Due to the stochasticity of the birth-death process, there is a
possibility of infections being removed before a major epidemic
occurred, so not all processes will lead to major outbreaks. Here, a
major epidemic is characterised as one that has a generally longer
duration and substantially greater number of cases than a minor epidemic
<span class="citation">(<a href="#ref-tritch_duration_2018" role="doc-biblioref">Tritch and Allen 2018</a>)</span>. Theoretically, only minor epidemics occur when
<span class="math inline">\(R_{0} &lt; 1\)</span> and given <span class="math inline">\(R_{0} &gt; 1\)</span>, the probabilities of a minor and
major epidemic are <span class="math inline">\(\left( 1\text{/}R_{0} \right)^{i}\)</span> and
<span class="math inline">\(1 - \left( 1\text{/}R_{0} \right)^{i}\)</span> respectively, where <span class="math inline">\(i\)</span> refers
to the initial number of infected individuals <span class="citation">(<a href="#ref-whittle_outcome_1955" role="doc-biblioref">Whittle 1955</a>)</span>. The
distinction between the two types of epidemics is illustrated nelow at different scales.</p>
<center>
<img src="/post/2020-06-10-application-of-birth-death-processes_files/outbreak%20comparison_1.png" />
<img src="/post/2020-06-10-application-of-birth-death-processes_files/outbreak%20comparison_2.png" />
</center>
<p>The probability of a major epidemic occurring can be approximated by the
proportion of simulated Markov chains that resulted in a major epidemic.
The results are summarised below.</p>
<center>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="center">Theoretical <span class="math inline">\(P(\text{major})\)</span></th>
<th align="center">Estimated <span class="math inline">\(P(\text{major})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="center">0.631</td>
<td align="center">0.84</td>
</tr>
<tr class="even">
<td align="left">Singapore</td>
<td align="center">0.881</td>
<td align="center">0.85</td>
</tr>
<tr class="odd">
<td align="left">South Korea</td>
<td align="center">0.219</td>
<td align="center">0.24</td>
</tr>
<tr class="even">
<td align="left">Sweden</td>
<td align="center">0.855</td>
<td align="center">0.86</td>
</tr>
<tr class="odd">
<td align="left">Thailand</td>
<td align="center">0.286</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
</center>
<p>The estimated probability of a major outbreak is largely correlated to
the theoretical value <span class="math inline">\(\left( R^{2} = 0.81 \right)\)</span>, although the
strength of association varies. The variance could be attributed two
sources: firstly, <span class="math inline">\(\lambda\text{/}\mu\)</span> is only a crude estimator of
<span class="math inline">\(R_{0} = \beta\text{/}\gamma\)</span> and secondly, the stochastic nature of the
simulations results in a variable probability of major outbreak. Only
the second source can be addressed by increasing the number of
simulations, which also increases the time and computational cost.</p>
<p>The results are consistent with the understanding that South Korea has
been successful in managing the outbreak and effectively reduced the
probability of a major outbreak occurring. On the other hand, the
probability of major outbreaks occurring in the other countries are
substantially higher.</p>
</div>
</div>
<div id="final-size" class="section level1">
<h1>3.2 Final Size</h1>
<p>The final size of the outbreak refers to the total number of people
expected to be infected by the disease. Bayes’ rule can be leveraged to
estimate the final size based on the outcome of the simulated epidemics.</p>
<p><span class="math display">\[E\left\lbrack \text{final size} \right\rbrack = E\left\lbrack \text{final size} \middle| \text{major} \right\rbrack P\left( \text{major} \right) + E\left\lbrack \text{final size} \middle| \text{minor} \right\rbrack P\left( \text{minor} \right)\]</span></p>
<center>
<img src="/post/2020-06-10-application-of-birth-death-processes_files/final_size.png" />
</center>
<p>The typical distribution of final sizes is illustrated above. The
distribution is characteristically bimodal with the final size depending
on whether a minor or major epidemic occurred. The simulation results
are summarised below and compared with the final size of the
deterministic models.</p>
<center>
<table>
<colgroup>
<col width="14%" />
<col width="19%" />
<col width="19%" />
<col width="18%" />
<col width="7%" />
<col width="13%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="center"><span class="math inline">\(E[\cdot|\text{major}]\)</span></th>
<th align="center"><span class="math inline">\(E[\cdot|\text{minor}]\)</span></th>
<th align="center"><span class="math inline">\(E[\text{final size}]\)</span></th>
<th align="center">%</th>
<th align="center">ODE</th>
<th align="center">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="center">1.73<span class="math inline">\(\times\)</span> 10<sup>7</sup></td>
<td align="center">3.25</td>
<td align="center">1.44<span class="math inline">\(\times\)</span> 10<sup>7</sup></td>
<td align="center">21.9</td>
<td align="center">1.71<span class="math inline">\(\times\)</span> 10<sup>7</sup></td>
<td align="center">26</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Singapore</td>
<td align="center">3.68<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">1</td>
<td align="center">3.12<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">53.4</td>
<td align="center">3.67<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">62.8</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">South Korea</td>
<td align="center">1.39<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">2.54</td>
<td align="center">3.35<span class="math inline">\(\times\)</span> 10<sup>5</sup></td>
<td align="center">0.652</td>
<td align="center">1.36<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">2.65</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Sweden</td>
<td align="center">5.79<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">1.36</td>
<td align="center">4.98<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">49.4</td>
<td align="center">5.79<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">57.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Thailand</td>
<td align="center">3.17<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">3.22</td>
<td align="center">1.58<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">2.23</td>
<td align="center">3.17<span class="math inline">\(\times\)</span> 10<sup>6</sup></td>
<td align="center">4.53</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</center>
<p>From the table above, the expected final sizes given that a major outbreak
occurred <span class="math inline">\(E[\cdot|\text{major}]\)</span> are very
similar to the deterministic ODE solution. Given that a minor outbreak
occurred, the expected final size is extremely small. A possible
interpretation of this is that the threshold for a major epidemic
occurring is very low, seeing that an outbreak only needs to exceed on
average 2-3 infections before it progresses into a large epidemic. This
is more likely in a homogenous population where people interact with
everyone else on a regular basis but that may not be a realistic
setting.</p>
<p>It is also interesting to note the differences in the estimated final
size <span class="math inline">\(E[\text{final size}]\)</span> and the ODE
solution. The estimated final sizes are much lower than the ODE
solutions because they account for the possibility of no major epidemics
occurring. In a way these can be interpreted as more realistic final
sizes than the deterministic solution.</p>
</div>
<div id="expected-duration" class="section level1">
<h1>3.3 Expected Duration</h1>
<p>The simulated results also allow one to estimate the duration of the
outbreak, or in other words, the extinction time. Most theoretical
research has focused on the duration of epidemics conditioned on
non-extinction (Tritch &amp; Allen, 2018). However, since the outbreaks were
simulated till extinction, this project will only estimate the duration
conditioned on extinction. Similar to the final size estimation, a
possible simulation-based estimate of duration can be formulated by
Bayes rule as such:</p>
<p><span class="math display">\[E\left\lbrack \text{duration} \right\rbrack = E\left\lbrack \text{d}\text{uration} \middle| \text{major} \right\rbrack P\left( \text{major} \right)\  + \ E\left\lbrack \text{duration} \middle| \text{minor} \right\rbrack P\left( \text{minor} \right)\]</span></p>
<center>
<img src="/post/2020-06-10-application-of-birth-death-processes_files/ext_times.png" />
</center>
<p>The plot above illustrates the distribution of extinction times. It follows a
clear bimodal distribution given the respective outcomes (minor or major
outbreaks). The results are summarised below. Since
deterministic epidemic models only approach 0 but never become fully
extinct, the extinction time for the ODE solution is taken to be when
<span class="math inline">\(I\left( t \right) &lt; 1\text{/}N\)</span>, or when there is less than 1 infected
person in the population.</p>
<center>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="center"><span class="math inline">\(E[\cdot|\text{major}]\)</span></th>
<th align="center"><span class="math inline">\(E[\cdot|\text{minor}]\)</span></th>
<th align="center"><span class="math inline">\(E[\text{duration}]\)</span></th>
<th align="center">ODE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="center">909</td>
<td align="center">23.4</td>
<td align="center">767</td>
<td align="center">894</td>
</tr>
<tr class="even">
<td align="left">Singapore</td>
<td align="center">1130</td>
<td align="center">7.00</td>
<td align="center">965</td>
<td align="center">1070</td>
</tr>
<tr class="odd">
<td align="left">South Korea</td>
<td align="center">3530</td>
<td align="center">60.1</td>
<td align="center">893</td>
<td align="center">3710</td>
</tr>
<tr class="even">
<td align="left">Sweden</td>
<td align="center">1870</td>
<td align="center">20.8</td>
<td align="center">1614</td>
<td align="center">1780</td>
</tr>
<tr class="odd">
<td align="left">Thailand</td>
<td align="center">1640</td>
<td align="center">33.5</td>
<td align="center">835</td>
<td align="center">1630</td>
</tr>
</tbody>
</table>
</center>
<p>Similar to the expected final size, the expected duration given a major
epidemic is close to the ODE solution. The overall expected duration can
also be interpreted as a more realistic figure than the ODE solution
since it accounts for the probability of only a minor outbreak
occurring.</p>
</div>
<div id="discussion" class="section level1">
<h1>4 Discussion</h1>
<p>The results summarised below illustrate that the selected countries have
varied success in managing the COVID-19 pandemic. As mentioned earlier
in this report, South Korea seemed to have the epidemic under control.
Although the outbreak in South Korea is expected to last for almost as
long as any other country, the low rates of <span class="math inline">\(\lambda,\ \mu\)</span> resulted in
the lowest probability of a major outbreak occurring and a substantially
smaller estimated final size. However, the model is only able to capture
one single epidemic and is unable to forecast future outbreaks which may
drastically affect the final size and duration.</p>
<center>
<table>
<colgroup>
<col width="10%" />
<col width="31%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="center">Estimated <span class="math inline">\(P(\text{major})\)</span></th>
<th align="center"><span class="math inline">\(E[\text{final size}]/N\)</span> (%)</th>
<th align="center"><span class="math inline">\(E[\text{duration}]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="center">0.84</td>
<td align="center">21.9</td>
<td align="center">767.44</td>
</tr>
<tr class="even">
<td align="left">Singapore</td>
<td align="center">0.85</td>
<td align="center">53.4</td>
<td align="center">965.03</td>
</tr>
<tr class="odd">
<td align="left">South Korea</td>
<td align="center">0.24</td>
<td align="center">0.652</td>
<td align="center">892.59</td>
</tr>
<tr class="even">
<td align="left">Sweden</td>
<td align="center">0.86</td>
<td align="center">49.4</td>
<td align="center">1613.81</td>
</tr>
<tr class="odd">
<td align="left">Thailand</td>
<td align="center">0.50</td>
<td align="center">2.23</td>
<td align="center">835.4</td>
</tr>
</tbody>
</table>
</center>
<p>Although the results may seem worrying for Singapore and Sweden, which
have an expected 53.4% and 49.4% of their population infected by COVD-19
respectively, it is important to note that these simulations were unable
to account for direct public health intervention to reduce disease
transmission. In Singapore, where strict physical distancing measures
have been introduced, the final size will likely be much lower than
expected. Nonetheless, these figures serve to highlight a possible
‘worst case’ scenario where COVID-19 is allowed to transmit freely in a
highly mixed, homogeneous population.</p>
</div>
<div id="limitations" class="section level1">
<h1>5 Limitations</h1>
<p>The BDP model used in this project was mainly limited by its
assumptions. Firstly, the model assumed a closed population for each
country, and did not consider the effects of births, deaths, or
immigration on the epidemic dynamics. This was not a realistic
assumption to make since the epidemics have been estimated to last for
more than 3 years, during which other demographic effects
might have affected the rates of infection and recovery, as well as the
population size. From initial reports during the pandemic, it was also
understood that immigration was a significant factor in transmission
<span class="citation">(<a href="#ref-pinotti_lessons_2020" role="doc-biblioref">Pinotti et al. 2020</a>)</span> and should be included in further analysis.</p>
<p>Secondly, for ease of estimating the likelihood, the removal process was
simplified to include both recovery and death. This ‘R’ state in SIR is
ambiguous and does not capture the severity of the outbreak beyond the
number of infected cases. In other words, a country may have a high
removal rate leading to a smaller epidemic, but this may or may not be a
satisfactory outcome depending on the number of recovered cases relative
to deaths. Future work may be undertaken to differentiate between
recovered cases and deaths in order to have a clearer representation of
the severity of the epidemic.</p>
<p>Furthermore, the Markov property, while useful in simplifying complex
phenomena, does not always hold in reality as it does not consider
historical trends beyond the past day, when in reality a lot of
processes that underpin disease transmission are dependent on time
periods much longer than one day. Thus, the BDP model is only useful for
early approximations.</p>
<p>It should also be noted that a model is only as good as the data it is
fed. The data used in the model only contains reported cases and the
proportion of cases reported varies largely depending on different
countries’ disease surveillance systems. This may not be representative
of the true state of COVID-19 in various countries especially if they
lack adequate testing. Nonetheless, the reported number of cases is the
most direct way that the state of the epidemic can be observed, even if
the statistics may be flawed.</p>
<p>Lastly, since the BDP approximation considers only +1 and -1 transitions
between states, it is a time-consuming process to estimate parameters
and conduct simulations for countries reported to have a large number of
infections. For this reason, countries that were adversely affected by
COVID-19 with over 100,000 confirmed cases, including the US, China and
Italy, were excluded from this study even though it would have been of
value to include them.</p>
</div>
<div id="conclusion" class="section level1">
<h1>6 Conclusion</h1>
<p>In conclusion, this project highlighted an application of birth-death
processes to the COVID-19 pandemic. Firstly, it introduced the
theoretical formulation of an SIR BDP and its transition probabilities.
Secondly, a data augmentation technique was used to overcome the
difficulty of computing maximum likelihood estimation on discretely
observed BDP. The parameter estimates were then used to simulate
outbreaks in different countries, and simulation-based inference was
conducted. Lastly, the limitations of applying the BDPs to study the
COVID-19 pandemic was discussed at length.</p>
<p>Overall, this project has shown that while the birth-death process is
useful in modelling the number of COVID-19 infections, it is largely
limited by its assumptions. The model could be refined by introducing
more flexibility in order to represent other more complex aspects of the
outbreak such as recovery, deaths, demographic trends, and public health
interventions.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-allen_primer_2017" class="csl-entry">
Allen, Linda J. S. 2017. <span>“A Primer on Stochastic Epidemic Models: <span>Formulation</span>, Numerical Simulation, and Analysis.”</span> <em>Infect Dis Model</em> 2 (2): 128–42. <a href="https://doi.org/10.1016/j.idm.2017.03.001">https://doi.org/10.1016/j.idm.2017.03.001</a>.
</div>
<div id="ref-crawford_estimation_2014" class="csl-entry">
Crawford, Forrest W., Vladimir N. Minin, and Marc A. Suchard. 2014. <span>“Estimation for General Birth-Death Processes.”</span> <em>J Am Stat Assoc</em> 109 (506): 730–47. <a href="https://doi.org/10.1080/01621459.2013.866565">https://doi.org/10.1080/01621459.2013.866565</a>.
</div>
<div id="ref-crawford_birth-death_2014" class="csl-entry">
Crawford, Forrest W., and Marc A. Suchard. 2014. <span>“Birth-Death Processes.”</span> <em>arXiv:1301.1305 [q-Bio, Stat]</em>, July. <a href="http://arxiv.org/abs/1301.1305">http://arxiv.org/abs/1301.1305</a>.
</div>
<div id="ref-jhu_csse_novel_2020" class="csl-entry">
CSSE, JHU. 2020. <span>“Novel <span>Coronavirus</span> (<span>COVID</span>-19) <span>Cases</span>.”</span> Johns Hopkins University. <a href="https://github.com/CSSEGISandData/COVID-19">https://github.com/CSSEGISandData/COVID-19</a>.
</div>
<div id="ref-cucinotta_who_2020" class="csl-entry">
Cucinotta, Domenico, and Maurizio Vanelli. 2020. <span>“<span>WHO</span> <span>Declares</span> <span>COVID</span>-19 a <span>Pandemic</span>.”</span> <em>Acta Biomed</em> 91 (1): 157–60. <a href="https://doi.org/10.23750/abm.v91i1.9397">https://doi.org/10.23750/abm.v91i1.9397</a>.
</div>
<div id="ref-gillespie_exact_1977" class="csl-entry">
Gillespie, Daniel T. 1977. <span>“Exact Stochastic Simulation of Coupled Chemical Reactions.”</span> <em>J. Phys. Chem.</em> 81 (25): 2340–61. <a href="https://doi.org/10.1021/j100540a008">https://doi.org/10.1021/j100540a008</a>.
</div>
<div id="ref-griffith_singapore_2020" class="csl-entry">
Griffith, James. 2020. <span>“Singapore Had a Model Coronavirus Response, Then Cases Spiked. <span>What</span> Happened?”</span> <em>CNN</em>, April. <a href="https://www.cnn.com/2020/04/18/asia/singapore-coronavirus-response-intl-hnk/index.html">https://www.cnn.com/2020/04/18/asia/singapore-coronavirus-response-intl-hnk/index.html</a>.
</div>
<div id="ref-keiding_maximum_1975" class="csl-entry">
Keiding, Niels. 1975. <span>“Maximum <span>Likelihood</span> <span>Estimation</span> in the <span>Birth</span>-and-<span>Death</span> <span>Process</span>.”</span> <em>Ann. Statist.</em> 3 (2): 363–72. <a href="https://doi.org/10.1214/aos/1176343062">https://doi.org/10.1214/aos/1176343062</a>.
</div>
<div id="ref-mckendrick_applications_1925" class="csl-entry">
McKendrick, A. G. 1925. <span>“Applications of <span>Mathematics</span> to <span>Medical</span> <span>Problems</span>.”</span> <em>Proceedings of the Edinburgh Mathematical Society</em> 44 (February): 98–130. <a href="https://doi.org/10.1017/S0013091500034428">https://doi.org/10.1017/S0013091500034428</a>.
</div>
<div id="ref-normile_coronavirus_2020" class="csl-entry">
Normile, Dennis. 2020. <span>“Coronavirus Cases Have Dropped Sharply in <span>South</span> <span>Korea</span>. <span>What</span>’s the Secret to Its Success?”</span> <em>Science <span><span></span></span> AAAS</em>. <a href="https://www.sciencemag.org/news/2020/03/coronavirus-cases-have-dropped-sharply-south-korea-whats-secret-its-success">https://www.sciencemag.org/news/2020/03/coronavirus-cases-have-dropped-sharply-south-korea-whats-secret-its-success</a>.
</div>
<div id="ref-pinotti_lessons_2020" class="csl-entry">
Pinotti, Francesco, Laura Di Domenico, Ernesto Ortega, Marco Mancastroppa, Giulia Pullano, Eugenio Valdano, Pierre-Yves Boelle, Chiara Poletto, and Vittoria Colizza. 2020. <span>“Lessons Learnt from 288 <span>COVID</span>-19 International Cases: Importations over Time, Effect of Interventions, Underdetection of Imported Cases.”</span> <em>medRxiv</em>, February, 2020.02.24.20027326. <a href="https://doi.org/10.1101/2020.02.24.20027326">https://doi.org/10.1101/2020.02.24.20027326</a>.
</div>
<div id="ref-rock_dynamics_2014" class="csl-entry">
Rock, Kat, Sam Brand, Jo Moir, and Matt J. Keeling. 2014. <span>“Dynamics of Infectious Diseases.”</span> <em>Rep. Prog. Phys.</em> 77 (2): 026602. <a href="https://doi.org/10.1088/0034-4885/77/2/026602">https://doi.org/10.1088/0034-4885/77/2/026602</a>.
</div>
<div id="ref-tritch_duration_2018" class="csl-entry">
Tritch, William, and Linda J. S. Allen. 2018. <span>“Duration of a Minor Epidemic.”</span> <em>Infectious Disease Modelling</em> 3 (January): 60–73. <a href="https://doi.org/10.1016/j.idm.2018.03.002">https://doi.org/10.1016/j.idm.2018.03.002</a>.
</div>
<div id="ref-ward_why_2020" class="csl-entry">
Ward, Alex. 2020. <span>“Why <span>France</span> Has 4 Times as Many Coronavirus Deaths as <span>Germany</span>.”</span> <em>Vox</em>. <a href="https://www.vox.com/2020/4/17/21223915/coronavirus-germany-france-cases-death-rate">https://www.vox.com/2020/4/17/21223915/coronavirus-germany-france-cases-death-rate</a>.
</div>
<div id="ref-whittle_outcome_1955" class="csl-entry">
Whittle, P. 1955. <span>“The <span>Outcome</span> of a <span>Stochastic</span> <span>Epidemic</span>–<span>A</span> <span>Note</span> on <span>Bailey</span>’s <span>Paper</span>.”</span> <em>Biometrika</em> 42 (1/2): 116–22. <a href="https://doi.org/10.2307/2333427">https://doi.org/10.2307/2333427</a>.
</div>
</div>
</div>
